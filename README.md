### Что тут происходит?

Финансовые рынки - это сложные системы с большим количеством разнообразных параметров. Какова же природа этой системы? Как ее описать математически и даже взможно предсказать ее поведение? Человечество рассматривает рынки под разными углами зрения, с разных сторон заходя к "священному граалю" прогнозирования его поведения. Например, есть мнение, что природа этой системы - носит стохастический характер, а поведение можно описать случайными процессами. Другой взгляд - попытка описать рынки как хаотические системы, т.е. такие системы, поведение которых полностью предсказуемо и определяется ее начальными условиями и законами, по которым она функционирует. Собственно это два кардинально разных подхода.

Рассмотрим сутевое содержание второго подхода. 
Фазовое пространство системы — это абстрактное многомерное пространство, в котором каждое возможное состояние системы представлено отдельной точкой. Это позволяет нам визуализировать динамику системы и отслеживать ее изменения во времени. Обычно фазовое пространство имеет столько измерений, сколько переменных необходимо для полного описания состояния системы.

Аттрактор - это область в фазовом пространстве, к которой со временем притягиваются траектории системы. Аттракторы могут быть точечными, что указывает на регулярное и предсказуемое поведение системы, или странными, с фрактальной структурой, которые описывают более сложные, непредсказуемые динамики, также аттрактор может отсутствовать, тогда система скорее случайна и может не иметь детерминированной структуры.

Одним из способом оценки размерности такого фазового пространства системы является метод Грассбергера-Прокаччиа. Кратко суть метода:
1. Рассчитывается мера, как часто точки оказываются близкими друг к другу при различных масштабах, как они группируются на разных масштабах пространства - корреляционный интеграл. 
2. Рассматривая зависимость корреляционного интеграла от масштаба в двойном логарифмическом пространстве мы можем оценить фрактальную размерность D исследуемой системы, показатель, описывающий сложность ее структуры. В некоторый момент уменьшения масштаба происходит насыщение и получаемый линейный наклон этой системы служит основой для вычисления фрактальной размерности D. Если насыщения не происходит - система не хаотической структуры. Т.е. мы находим линейный участок и считаем угол наклона, который и будет фрактальной размерностью D.
3. Далее смотрим, что будет с фрактальной размерностью при увеличении числа измерений. Если график будет стремиться к насыщению, значит мы можем оценить минимальную размерность, при которой система будет корректно отображаться. Иначе - система не хаотична. А именно, искомая размерность фазового пространства системы не превысит удвоенное значение выбранной "насыщенной" величины размерности.

Аналогично, для расчета фрактальной размерности (Минковского) есть более компьютеризированный метод Box-Counting. Им мы тоже посчитаем, а подробнее про него можно почитать, например, [тут](https://habr.com/ru/articles/208368/)





Далее
С развитием НС метод ГП утратил популярность, появились более устойчивые к шуму реальных данных и более точные методы
- LSTM (Long Short-Term Memory Networks) Это тип рекуррентных нейронных сетей (RNN), специально разработанный для работы с длинными временными рядами. LSTM учитывает долгосрочные зависимости и игнорирует несущественную информацию, что важно для анализа долгосрочных рыночных трендов
- Transformer Models (например, Temporal Fusion Transformer, TST), Модели Transformer изначально разработаны для задач NLP, но их архитектура подходит и для временных рядов. Модели, такие как Temporal Fusion Transformer (TFT), могут обрабатывать временные зависимости и учитывать множественные временные масштабы.
- WaveNet Модель WaveNet была разработана для генерации аудиоданных, но адаптирована для анализа временных рядов. Она использует каузальные свёрточные сети (causal convolutional networks), которые позволяют учитывать последовательные зависимости.
- Prophet — это статистическая модель для анализа временных рядов, которая особенно хорошо подходит для данных с сезонностью, выходными, праздниками и другими эффектами. Модель автоматически подстраивается к изменениям в данных.
- ARIMA хорошо подходит для временных рядов с трендами, а GARCH — для данных с переменной волатильностью. В сочетании они эффективно справляются с анализом финансовых данных.
- N-BEATS (Neural Basis Expansion Analysis for Time Series) Это полностью соединённая нейронная сеть, разработанная специально для временных рядов. Она работает без сложного предобучения и может автоматически выявлять сезонные и трендовые компоненты.
- XGBoost и LightGBM градиентные бустинг-алгоритмы показали высокую точность при работе с временными рядами. В сочетании с функциями, выделяющими временные зависимости, они обеспечивают высокую точность и скорость.
- Hidden Markov Models (HMM) HMM используется для определения скрытых состояний в данных. Это может быть полезно для определения «режимов» рынка, таких как «бычий» или «медвежий» тренд.
- Convolutional Neural Networks (CNN) для временных рядов CNN традиционно применялись для анализа изображений, но показали эффективность и для временных рядов. Их можно использовать для выявления локальных паттернов и трендов.
- Dynamic Time Warping (DTW) и K-Nearest Neighbors (KNN) DTW измеряет сходство между временными рядами и может помочь находить схожие паттерны в исторических данных. В сочетании с KNN позволяет находить похожие периоды в данных и прогнозировать на их основе.


# 1. Считаем корреляционный интеграл 
(Кузнецов, Динамический хаос, Глава 13)

Ищем количественный критерий динамической природы обрабатываемой реализации. По теореме Такенса численная оценка ограничения сверху размерности оправдана.

оцениваем размерность аттрактора некоторого множества точек в m-мерном пространстве (как фазовый портрет аттарктора) по методу 
Грассбергера-Прокаччиа (метод запазнывания в пространстве размерности m), т.е. вычисляем для разных эпсилон корреляционный интеграл

формируем m-мерный вектор с временным сдвигом p, тогда, если предположить, что мы имеем дело с установившимся режимом колебаний диссипативной системы, то возникающая при таком построении картинка есть реконструированный портрет аттрактора

main
corrint - запуск расчета методом Грассбергера-Прокаччиа
boxc - запуск расчета методом box-counting
mnk - запуск метода расчета угла наклона кривой


functions
estandsave_corrint расчет корреляционной размерности по методу Грассбергера-Прокаччиа
mnk - расчет по методу наименьших квадратов угла наклона кривой 
boxc - метод расчета фрактальной размерности по методу box-counting


### Входные данные config.h:
N - количество исследуемых точек, длина некоторого временного ряда
min_m - минимальная размерность
max_m - максимальная размерность
speed_m - шаг переключения размерности
min_eps - минимальная эпсилон
max_eps - максимальная эпсилон
эпсилон - это некоторая величина, относительно которой считаем вероятности попадания двух взятых наугад точек в этот диапазон,
минимальный размер "единичной ячейки"
p - некоторое целое число, которое надо подобрать так, чтобы улучшить результат, окно сдвига, неоторый временной шаг, чтобы брать вектор с компонентами: {x(t), x(t-p), x(t-2p),...,x(t-(m-1)p)}. В учебнике Кузнецова это параметр /tau
пронумерованное сгенерированное множество для оценки фрактальной размерности, тут на примере  множества кантора
NAME_DATAFILE = set_kantor.txt

### Выходные данные:
рассчитанные параметры - результирующие значения для построения графика,
уже посчитанные в логарифмическом масштабе
m - некоторая заданная размерность пространства точек
epsilon - размер "единичной ячейки"
C - корреляционный интеграл

NAME_FILERESULT = res_kantor.txt

### Запуск расчетов 
start est_corrint corrint {boxc, mnk}

# 2. Графическая оценка размерности аттрактора
Строим два графика:
## 1 график
Оцениваем размерность по наклону зависимости корреляционного интеграла от размера элемента покрытия в двойном логарифмическом масштабе
ось х - эпсилон
ось y - корреляционный интеграл

![Рисунок 1](https://github.com/aaviis/est_dims/blob/main/graphs/1%20graph%20D(m)-eps.png)

На графике ищем линейный участок и на нем считаем угловой коэффициент наклона D(m) для графика с фиксированной m

Ищем насыщение на некотором уровне D, эту величину D примем в качестве оценки корреляционной размерности аттактора динамической системы, породившей наблюдаемый сигнал.

Тогда, на основании теоремы о вложениях (теорема Мане), можно заключить, что размерность фазового пространства этой динамической системы не превышает 2D+1


## 2 график
Оцениваем зависимость результатов оценки размерности в зависимости от размерности вложения m
![Рисунок 2](https://github.com/aaviis/est_dims/blob/main/graphs/2%20saturation%20points.png)

По насыщению данного графика можем оценить размерность вложения

Строим график 
ось х - размерность m
ось y - оценка корреляционного интеграла по 1 графику при фиксированной m

![Рисунок 3](https://github.com/aaviis/est_dims/blob/main/graphs/3%20different_p.png)


### Литература

[Список объектов с их фрактальными размерностями](https://en.wikipedia.org/wiki/List_of_fractals_by_Hausdorff_dimension)
[С.П.Кузнецов Динамический хаос](https://sgtnd.narod.ru/pabl/rus/dc.htm)  
[Вычисление фрактальной размерности Минковского для плоского изображения](https://habr.com/ru/articles/208368/)
